<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>360°全景图预览体验</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <style>
        /* 保持原有样式不变 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #121212;
            color: white;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        #ui-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }
        
        #info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 16px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 300px;
            transition: opacity 0.5s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            pointer-events: auto;
        }
        
        #info-panel h2 {
            margin-bottom: 12px;
            font-size: 18px;
            color: #6eb6ff;
        }
        
        #info-panel ul {
            list-style-type: none;
            margin-left: 5px;
        }
        
        #info-panel li {
            margin-bottom: 8px;
            padding-left: 15px;
            position: relative;
            font-size: 14px;
            line-height: 1.5;
        }
        
        #info-panel li:before {
            content: "•";
            position: absolute;
            left: 0;
            color: #6eb6ff;
            font-size: 16px;
        }
        
        #toggle-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            pointer-events: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3;
        }
        
        #toolbar {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            pointer-events: auto;
            background: rgba(0, 0, 0, 0.7);
            padding: 12px 20px;
            border-radius: 50px;
        }
        
        .tool-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #title {
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: 600;
            color: white;
        }
        
        .notification {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none;
            z-index: 4;
        }
        
        .notification.show {
            opacity: 1;
        }
        
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top: 4px solid #6eb6ff;
            animation: spin 1.2s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="loading-screen">
        <div class="loader"></div>
        <p>加载全景图中...</p>
    </div>
    
    <div id="canvas-container"></div>
    
    <div id="ui-overlay">
        <div id="title">360°全景体验</div>
        
        <div id="info-panel">
            <h2>操作指南</h2>
            <ul>
                <li>鼠标拖动 - 旋转视角</li>
                <li>鼠标滚轮 - 缩放视图</li>
                <li>ESC键 - 重置视角</li>
                <li>空格键 - 切换自动旋转</li>
            </ul>
        </div>
        
        <button id="toggle-info">i</button>
        
        <div id="toolbar">
            <button class="tool-btn" id="reset-view" title="重置视图">↺</button>
            <button class="tool-btn" id="toggle-rotation" title="自动旋转">⟳</button>
            <button class="tool-btn" id="zoom-in" title="放大">+</button>
            <button class="tool-btn" id="zoom-out" title="缩小">-</button>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>

    <script>
        // 初始化变量
        let scene, camera, renderer, controls;
        let autoRotate = false;
        let canvasElement;
        
        // 显示通知
        function showNotification(text) {
            const notification = document.getElementById('notification');
            notification.textContent = text;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }
        
        // 初始化场景
        function init() {
            // 创建场景
            scene = new THREE.Scene();
            
            // 创建相机
            camera = new THREE.PerspectiveCamera(
                75,
                window.innerWidth / window.innerHeight,
                1,
                1000
            );
            camera.position.set(0, 0, 0.1);
            
            // 创建渲染器
            renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                alpha: true
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            
            const canvasContainer = document.getElementById('canvas-container');
            canvasContainer.appendChild(renderer.domElement);
            canvasElement = renderer.domElement;
            
            // 加载你的全景图 - 这里替换为你的图片路径
            const textureLoader = new THREE.TextureLoader();
            const panoramaTexture = textureLoader.load(
                'panorama.jpg',  // ← 在这里替换为你的图片路径
                () => {
                    document.getElementById('loading-screen').style.display = 'none';
                    showNotification('全景图加载完成');
                },
                undefined,
                (error) => {
                    console.error('图片加载失败：', error);
                    document.getElementById('loading-screen').style.display = 'none';
                    showNotification('图片加载失败，请检查路径是否正确');
                }
            );
            
            // 创建球形几何体
            const sphereGeometry = new THREE.SphereGeometry(500, 60, 40);
            
            // 创建材质
            const sphereMaterial = new THREE.MeshBasicMaterial({
                map: panoramaTexture,
                side: THREE.BackSide
            });
            
            // 创建球体网格
            const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
            scene.add(sphere);
            
            // 初始化控制器
            controls = new THREE.OrbitControls(camera, canvasElement);
            controls.enableZoom = true;
            controls.enableRotate = true;
            controls.enablePan = false;
            controls.dampingFactor = 0.05;
            controls.rotateSpeed = 0.5;
            controls.zoomSpeed = 0.7;
            
            controls.listenToKeyEvents(window);
            controls.update();
            
            // 添加窗口调整事件
            window.addEventListener('resize', onWindowResize);
            
            // 设置UI交互
            setupUI();
            
            // 开始动画循环
            animate();
        }
        
        // 窗口大小调整
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // 切换自动旋转
        function toggleAutoRotation() {
            autoRotate = !autoRotate;
            controls.autoRotate = autoRotate;
            controls.autoRotateSpeed = autoRotate ? 1.0 : 0;
            
            const btn = document.getElementById('toggle-rotation');
            btn.classList.toggle('active', autoRotate);
            showNotification(autoRotate ? '自动旋转已开启' : '自动旋转已关闭');
        }
        
        // 设置UI交互
        function setupUI() {
            // 切换信息面板
            document.getElementById('toggle-info').addEventListener('click', () => {
                const infoPanel = document.getElementById('info-panel');
                infoPanel.style.opacity = infoPanel.style.opacity === '0' ? '1' : '0';
            });
            
            // 重置视图
            document.getElementById('reset-view').addEventListener('click', () => {
                controls.reset();
                showNotification('视角已重置');
            });
            
            // 自动旋转按钮
            document.getElementById('toggle-rotation').addEventListener('click', toggleAutoRotation);
            
            // 缩放按钮
            document.getElementById('zoom-in').addEventListener('click', () => {
                controls.dollyOut(0.5);
            });
            
            document.getElementById('zoom-out').addEventListener('click', () => {
                controls.dollyIn(0.5);
            });
            
            // 键盘事件
            window.addEventListener('keydown', (event) => {
                switch(event.key) {
                    case 'Escape':
                        controls.reset();
                        showNotification('视角已重置');
                        break;
                    case ' ':
                        toggleAutoRotation();
                        break;
                }
            });
        }
        
        // 动画循环
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        
        // 页面加载完成后初始化
        window.addEventListener('load', init);
    </script>
</body>
</html>
    